<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Smart Polyglot Command Generator</title>
  <style>
    body {
      font-family: "Segoe UI", Roboto, sans-serif;
      background:#f9fafb;
      color:#333;
      padding:30px;
      max-width:600px;
      margin:auto;
    }
    h3 {
      text-align:center;
      color:#222;
      margin-bottom:20px;
    }
    label {
      font-weight:600;
      display:block;
      margin-top:12px;
    }
    textarea, input {
      width:100%;
      padding:8px 10px;
      margin-top:5px;
      border:1px solid #ccc;
      border-radius:6px;
      font-family:monospace;
      font-size:14px;
    }
    textarea::placeholder {
      color:#9ca3af;
      font-style:italic;
    }
    button {
      margin-top:12px;
      padding:8px 14px;
      border:none;
      border-radius:6px;
      background:#2563eb;
      color:white;
      font-weight:600;
      cursor:pointer;
      transition:background 0.2s;
    }
    button:hover { background:#1e4ed8; }
    .block {
      background:#fff;
      border:1px solid #e5e7eb;
      border-radius:6px;
      padding:10px;
      margin:12px 0;
      display:flex;
      align-items:center;
      justify-content:space-between;
      box-shadow:0 1px 2px rgba(0,0,0,0.05);
    }
.block code {
  white-space:pre-wrap;
  font-size:14px;
  color:#111;
  display:block;
}

    button.copy {
      margin-left:12px;
      background:#f3f4f6;
      color:#374151;
      border:1px solid #d1d5db;
      font-size:13px;
      padding:4px 10px;
      transition:all 0.2s;
    }
    button.copy:hover { background:#e5e7eb; }
    button.copied {
      background:#d1fae5;
      border-color:#10b981;
      color:#065f46;
      font-weight:600;
    }
  </style>
</head>
<body>
  <h3>Smart Polyglot Command Generator</h3>

  <label>Paste your <code>ls</code> output:</label>
  <textarea id="lsout" rows="3" 
    placeholder="Paste your ls output here
Example:
dan_files.zip    to_1.png"></textarea>
  <button onclick="parse()">Parse</button>

  <label>Image file:</label>
  <input id="img">

  <label>Zip file:</label>
  <input id="zip">

  <label>Hybrid output:</label>
  <input id="hybrid" value="hybrid.png">

  <button onclick="gen()">Generate Commands</button>

  <div id="out"></div>

  <script>
    function parse(){
      let txt = document.getElementById('lsout').value;
      let parts = txt.split(/\s+/);
      let img = parts.find(f => /\.(png|jpg|jpeg)$/i.test(f)) || "";
      let zip = parts.find(f => /\.zip$/i.test(f)) || "";

      document.getElementById('img').value = img;
      document.getElementById('zip').value = zip;

      // Auto-detect extension from image file
      let ext = img.split('.').pop();
      document.getElementById('hybrid').value = "hybrid." + ext;
    }

    function gen(){
      let img = document.getElementById('img').value;
      let zip = document.getElementById('zip').value;
      let hybrid = document.getElementById('hybrid').value;

      // Zip both image and payload, append to image, then delete outer.zip
      let addCmd = "zip outer.zip " + img + " " + zip + " && cat " + img + " outer.zip > " + hybrid + " && rm outer.zip";
      let extCmd = "unzip " + hybrid;

      document.getElementById('out').innerHTML =
        block("cmd1", addCmd) + block("cmd2", extCmd);
    }

    function block(id, text){
      return `<div class="block">
        <code id="${id}">${text}</code>
        <button class="copy" onclick="copyText('${id}', this)">Copy</button>
      </div>`;
    }

    function copyText(id, btn){
      let text = document.getElementById(id).innerText;
      navigator.clipboard.writeText(text).then(() => {
        btn.innerText = "Copied!";
        btn.classList.add("copied");
      });
    }
  </script>
</body>
</html>
